<!DOCTYPE html>
<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>camera</title>
	<style type="text/css">
		body { margin: 0; overflow: hidden; background-color: green; }
		#root { display: flex; flex-direction: column; justify-content: flex-start; align-items: center; }
		#root { position: absolute; left: 0; right: 0; top: 0; bottom: 0; padding: 20px; overflow: scroll; }
	</style>
</head><body>
	<div id="root">
		<video id="video" width="240" height="240" autoplay playsinline ></video>
		<input id="inputRangeFocus" type="range"></input>
		<br>
		<div id="setting" style="width: 300px; background-color: silver;"></div>
		<br>
		<div id="supported" style="width: 300px; background-color: silver;"></div>
	</div>
	<script type="text/javascript">
"use strict";

// ----------------------------------------------------------------
// ----------------------------------------------------------------
// ----------------------------------------------------------------

document.addEventListener("DOMContentLoaded", async event => {
	const stream = await navigator.mediaDevices.getUserMedia({
		video: { facingMode: "environment" },
		audio: false,
	});
	document.getElementById("video").srcObject = stream;

	const track = stream.getVideoTracks()[0];
	document.getElementById("setting").innerHTML = JSON.stringify(track.getSettings(), null, "  ").replaceAll("\n", "<br>");
	document.getElementById("supported").innerHTML = JSON.stringify(track.getCapabilities(), null, "  ").replaceAll("\n", "<br>");
	document.getElementById("inputRangeFocus").min = track.getCapabilities().focusDistance.min;
	document.getElementById("inputRangeFocus").max = track.getCapabilities().focusDistance.max;
	document.getElementById("inputRangeFocus").step = track.getCapabilities().focusDistance.step;
	document.getElementById("inputRangeFocus").value = track.getSettings().focusDistance;

	document.getElementById("inputRangeFocus").addEventListener("input", event => {
		track.applyConstraints({
			advanced: [{
				focusMode: "manual",
				focusDistance: document.getElementById("inputRangeFocus").value
			}]
		});
	});
});

// ----------------------------------------------------------------
// ----------------------------------------------------------------
// ----------------------------------------------------------------
	</script>
</body></html>